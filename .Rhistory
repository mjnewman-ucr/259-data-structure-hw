install.packages("rvest")
#Load packages
library(tidyverse)
library(lubridate)
library(rvest)
# Scrape the data for the new rolling stone top 500 list
url <- "https://stuarte.co/2021/2021-full-list-rolling-stones-top-500-songs-of-all-time-updated/"
rs_new <- url %>% read_html() %>% html_nodes(xpath='//*[@id="post-14376"]/div[2]/div[2]/table') %>% html_table() %>% pluck(1)
# Scrape the data for the old rolling stone top 500 list
url_old <- "https://www.cs.ubc.ca/~davet/music/list/Best9.html"
rs_old <- url_old %>% read_html() %>% html_nodes(xpath='/html/body/table[2]') %>% html_table() %>% pluck(1) %>%
select(1, 4, 3, 7) %>% rename(Rank = X1, Artist = X3, Song = X4, Year = X7) %>% filter(Year != "YEAR")
View(rs_new)
#ANSWER
full_join(rs_new, rs_old, by = Artist, Song)
#ANSWER
full_join(rs_new, rs_old, by = c("Artist", "Song"))
nrow()
#ANSWER
rs_joined_orig <- full_join(rs_new, rs_old, by = c("Artist", "Song"))
nrow(rs_joined_orig)
View(rs_joined_orig)
View(rs_old)
#ANSWER
rs_new %>% mutate(Source = New)
#ANSWER
rs_new %>% mutate(Source = "New")
rs_old %>% as.numeric(c("Year", "Rank") mutate(Source = "Old")
rs_old %>% as.numeric("Year") mutate(Source = "Old")
rs_old %>% as.numeric(c("Year", "Rank")) %>% mutate(Source = "Old")
rs_old %>% as.numeric(c("Year", "Rank")) %>% mutate(Source = "Old", na.rm = TRUE)
rs_old %>% as.numeric(c("Year", "Rank")) #%>% mutate(Source = "Old", na.rm = TRUE)
rs_old %>% as.numeric("Year") #%>% mutate(Source = "Old", na.rm = TRUE)
rs_old %>% as.integer("Year") #%>% mutate(Source = "Old", na.rm = TRUE)
rs_old %>% as.integer("Year", na.rm = TRUE) #%>% mutate(Source = "Old", na.rm = TRUE)
rs_old %>% as.double("Year", na.rm = TRUE) #%>% mutate(Source = "Old", na.rm = TRUE)
rs_old %>% as.double(Year, na.rm = TRUE) #%>% mutate(Source = "Old", na.rm = TRUE)
rs_old %>% as.numeric(Year, na.rm = TRUE) #%>% mutate(Source = "Old", na.rm = TRUE)
rs_old %>% as.numeric("Year", na.rm = TRUE) #%>% mutate(Source = "Old", na.rm = TRUE)
rs_old %>% as.numeric(rs_old$Year, na.rm = TRUE) #%>% mutate(Source = "Old", na.rm = TRUE)
as.numeric(rs_old$Year, na.rm = TRUE) #%>% mutate(Source = "Old", na.rm = TRUE)
rs_old <- as.numeric(rs_old$Year)
rs_old <- as.numeric(rs_old$Rank)
# Scrape the data for the new rolling stone top 500 list
url <- "https://stuarte.co/2021/2021-full-list-rolling-stones-top-500-songs-of-all-time-updated/"
rs_new <- url %>% read_html() %>% html_nodes(xpath='//*[@id="post-14376"]/div[2]/div[2]/table') %>% html_table() %>% pluck(1)
# Scrape the data for the old rolling stone top 500 list
url_old <- "https://www.cs.ubc.ca/~davet/music/list/Best9.html"
rs_old <- url_old %>% read_html() %>% html_nodes(xpath='/html/body/table[2]') %>% html_table() %>% pluck(1) %>%
select(1, 4, 3, 7) %>% rename(Rank = X1, Artist = X3, Song = X4, Year = X7) %>% filter(Year != "YEAR")
#ANSWER
rs_joined_orig <- full_join(rs_new, rs_old, by = c("Artist", "Song"))
nrow(rs_joined_orig)
rs_old$Year <- as.numeric(rs_old$Year)
rs_old$Rank <- as.numeric(rs_old$Rank)
rs_old %>% mutate(Source = "Old", na.rm = TRUE)
rs_old %>% mutate(Source = "Old")
bind_rows(rs_old, rs_new)
#ANSWER
rs_new <- rs_new %>% mutate(Source = "New")
rs_old <- rs_old %>% mutate(Source = "Old")
bind_rows(rs_old, rs_new)
rs_all <- bind_rows(rs_old, rs_new)
View(rs_all)
#ANSWER
rs_all %>% str_remove_all(Artist, "[The]")
#ANSWER
rs_all %>% str_remove_all(Artist, "The")
#ANSWER
rs_all %>% str_remove_all(Artist, The)
#ANSWER
rs_all %>% str_remove_all(rs_all$Artist, "The")
#ANSWER
rs_all %>% str_remove_all(Artist, "The", "")
#ANSWER
str_remove_all(rs_all$Artist, "The")
#Load packages
library(tidyverse)
library(lubridate)
library(rvest)
# Scrape the data for the new rolling stone top 500 list
url <- "https://stuarte.co/2021/2021-full-list-rolling-stones-top-500-songs-of-all-time-updated/"
rs_new <- url %>% read_html() %>% html_nodes(xpath='//*[@id="post-14376"]/div[2]/div[2]/table') %>% html_table() %>% pluck(1)
# Scrape the data for the old rolling stone top 500 list
url_old <- "https://www.cs.ubc.ca/~davet/music/list/Best9.html"
rs_old <- url_old %>% read_html() %>% html_nodes(xpath='/html/body/table[2]') %>% html_table() %>% pluck(1) %>%
select(1, 4, 3, 7) %>% rename(Rank = X1, Artist = X3, Song = X4, Year = X7) %>% filter(Year != "YEAR")
#ANSWER
rs_joined_orig <- full_join(rs_new, rs_old, by = c("Artist", "Song"))
nrow(rs_joined_orig)
#ANSWER
rs_new <- rs_new %>% mutate(Source = "New")
rs_old$Year <- as.numeric(rs_old$Year)
rs_old$Rank <- as.numeric(rs_old$Rank)
rs_old <- rs_old %>% mutate(Source = "Old")
rs_all <- bind_rows(rs_old, rs_new)
#ANSWER
str_remove_all(rs_all$Artist, "The")
#ANSWER
str_remove_all(rs_all$Artist, "The ")
#ANSWER
str_remove_all(rs_all$Artist, "The ") %>% str_replace_all(rs_all$Artist, "&", "and")
#ANSWER
str_remove_all(rs_all$Artist, "The ") %>% str_replace_all(rs_all$Artist, "&" = "and")
#ANSWER
str_remove_all(rs_all$Artist, "The ") %>% str_replace_all(rs_all$Artist, "&", "and")
#ANSWER
str_remove_all(rs_all$Artist, "The ") str_replace_all(rs_all$Artist, "&", "and")
str_replace_all(rs_all$Artist, "&", "and")
#ANSWER
str_remove_all(rs_all$Artist, "The ")
str_remove_all(rs_all$Song, "The ")
str_replace_all(rs_all$Artist, "&", "and")
str_replace_all(rs_all$Song, "&", "and")
str_remove_all(rs_all$Song, "[punct]")
str_remove_all(rs_all$Song, "[[punct]]")
str_remove_all(rs_all$Song, "[:punct:]")
#ANSWER
rs_all <- str_remove_all(rs_all$Artist, "The ") %>%
str_remove_all(rs_all$Song, "The ") %>%
str_replace_all(rs_all$Artist, "&", "and") %>%
str_replace_all(rs_all$Song, "&", "and") %>%
str_remove_all(rs_all$Song, "[:punct:]") %>%
str_remove_all(rs_all$Artist, "[:punct:]")
#ANSWER
rs_all %>% str_remove_all(Artist, "The ")
#ANSWER
rs_all %>% str_remove_all($Artist, "The ")
#ANSWER
rs_all %>% str_remove_all("Artist", "The ")
#ANSWER
rs_all <- str_remove_all(rs_all$Artist, "The ")
rs_all <- str_remove_all(rs_all$Song, "The ")
url <- "https://stuarte.co/2021/2021-full-list-rolling-stones-top-500-songs-of-all-time-updated/"
rs_new <- url %>% read_html() %>% html_nodes(xpath='//*[@id="post-14376"]/div[2]/div[2]/table') %>% html_table() %>% pluck(1)
# Scrape the data for the old rolling stone top 500 list
url_old <- "https://www.cs.ubc.ca/~davet/music/list/Best9.html"
rs_old <- url_old %>% read_html() %>% html_nodes(xpath='/html/body/table[2]') %>% html_table() %>% pluck(1) %>%
select(1, 4, 3, 7) %>% rename(Rank = X1, Artist = X3, Song = X4, Year = X7) %>% filter(Year != "YEAR")
### Question 1 ----------
# Use "full_join" to merge the old and new datasets, rs_new and rs_old,
# by Artist AND Song. Save the results to a dataset called rs_joined_orig
# If the merged worked, each song-artist combination that appears in both
# datasets should now be in a single row with the old/new ranks
# Use the nrow() function to see how many rows of data there are
# In the viewer, take a look at the merge...what kinds of problems are there?
# Why did some of the artist-song fail to match up?
#ANSWER
rs_joined_orig <- full_join(rs_new, rs_old, by = c("Artist", "Song"))
nrow(rs_joined_orig)
#There are a lot of "extra" rows! I think it is because some artists/songs are in
#one data set but not the other. For example, Kanye is not in the old ds
### Question 2 ----------
# To clean up the datasets, it would be more efficient to put them into a single data set
# Add a new variable to each dataset called "Source" with value "New" for rs_new and
# "Old" for rs_old. Then use bind_rows to join the two datasets into a single one called rs_all
# You will run into a problem because the old dataset has rank/year as characters instead of integers
# Make Rank and Year into integer variables for rs_old before binding them into rs_all
#ANSWER
rs_new <- rs_new %>% mutate(Source = "New")
rs_old$Year <- as.numeric(rs_old$Year)
rs_old$Rank <- as.numeric(rs_old$Rank)
rs_old <- rs_old %>% mutate(Source = "Old")
rs_all <- bind_rows(rs_old, rs_new)
#ANSWER
rs_all$Artist <- str_remove_all(rs_all$Artist, "The ")
rs_all$Song <- str_remove_all(rs_all$Song, "The ")
rs_all$Artist <- str_replace_all(rs_all$Artist, "&", "and")
rs_all$Song <- str_replace_all(rs_all$Song, "&", "and")
rs_all&Song <- str_remove_all(rs_all$Song, "[:punct:]")
rs_all$Song <- str_remove_all(rs_all$Song, "[:punct:]")
rs_all$Artist <- str_remove_all(rs_all$Artist, "[:punct:]")
